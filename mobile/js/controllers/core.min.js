sehaApp.controller("AboutCtrl",["$scope","Data","$ionicLoading",function(a,b,c){c.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),a.content=null,a.$on("$ionicView.loaded",function(a){c.hide()})}]),sehaApp.controller("AdvertiseCtrl",["$scope","$window","$state","Data","$ionicLoading","$translate",function(a,b,c,d,e,f){a.user={name:"",company_name:"",phone:"",email:"",message:""},f(["advertise_text"]).then(function(b){a.user.message=b.advertise_text}),a.sendRequest=function(c){if(c){e.show({template:'<div class="hg-loader"></div> <br/>Sending Request...',noBackdrop:!0});var g={name:a.user.name,company_name:a.user.company_name,phone:a.user.phone,email:a.user.email,message:a.user.message};d.post("advertise",g).then(function(c){e.hide(),200==c.code?(f(["success"]).then(function(a){b.alert(a.success)}),a.user={name:"",company_name:"",phone:"",email:"",message:"Hi, we want to get listed with 360Seha."}):f(["unknown_error"]).then(function(a){b.alert(a.unknown_error)})})}}}]),sehaApp.controller("ArticlesCtrl",["$scope","Data","CONSTS","$ionicLoading",function(a,b,c,d){d.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),a.articles=[],a.baseUrl=c.BASE_URL,b.get("articles").then(function(b){a.articles=200==b.code?_(b.data).toArray():null,d.hide()}),a.LoadData=function(){var c=a.articles.length;b.get("articles"+dataUrl+"&start="+c).then(function(b){if(200==b.code){var c=_(b.data).toArray();a.articles=_.union(a.articles,c),a.moreData=!1}else a.moreData=!0;a.$broadcast("scroll.infiniteScrollComplete")})},a.share=function(a,b,c){}}]),sehaApp.controller("ArticleDetailsCtrl",["$scope","Data","CONSTS","$stateParams","$ionicLoading",function(a,b,c,d,e){e.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),a.article=[],a.ads=[],a.baseUrl=c.BASE_URL,b.get("article_details?id="+d.id).then(function(b){a.article=200==b.code?b.data:null,e.hide()}),a.share=function(a,b,c){}}]),sehaApp.controller("AsyncSearchCtrl",["$scope","CONSTS","Data","$ionicModal","$ionicPopup","$localStorage","$timeout","$state","$http","$ionicScrollDelegate",function(a,b,c,d,e,f,g,h,i,j){a.suggestions=[],a.showList=!1,a.user={qry:""},c.get("suggest").then(function(b){a.suggestions=200==b.code&&_(b.data).toArray()}),a.getSuggestions=function(){a.showList=""!=a.user.qry,j.$getByHandle("search-scroll").scrollTop(!0)}}]),sehaApp.controller("CountryCtrl",["$scope","CONSTS","Data","$ionicModal","$ionicPopup","$localStorage","$timeout","$state","$ionicLoading","$translate",function(a,b,c,d,e,f,g,h,i,j){i.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),a.country="undefined"!=typeof f.country&&null!=f.country?f.country:null,a.countryEn="undefined"!=typeof f.countryEn&&null!=f.countryEn?f.countryEn:null,a.countryAr="undefined"!=typeof f.countryAr&&null!=f.countryAr?f.countryAr:null,a.baseUrl=b.BASE_URL,f.lang="undefined"!=typeof f.lang&&null!=f.lang?f.lang:"English",j.use(f.lang),c.get("country").then(function(b){a.country=200==b.code?_(b.data).toArray():null,i.hide()}),a.chooseCountry=function(b){f.country=b.id,a.countryEn=f.countryEn=b.name_en,a.countryAr=f.countryAr=b.name_ar,h.go("app.home")},a.isChosen=function(a){var b="undefined"!=typeof f.country&&null!=f.country?f.country:null;return b==a}}]),sehaApp.controller("EmergencyCtrl",["$scope","CONSTS","Data","$state","$ionicLoading","$rootScope","$location","$geolocation",function(a,b,c,d,e,f,g,h){function i(){h.getCurrentPosition({timeout:6e4}).then(function(b){l+="?lat="+b.coords.latitude+"&lng="+b.coords.longitude,a.curr_lat=lat=b.coords.latitude,a.curr_long=lng=b.coords.longitude,j(l)})}function j(b){e.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),c.get("emergency"+b).then(function(b){a.users=200==b.code?_(b.data).toArray():null,e.hide()})}function k(b,d,f){c.get("profile?id="+f+"&lat="+b+"&lng="+d).then(function(b){a.popUser=200==b.code?b.data:null,e.hide()})}a.users=[],a.view="list",a.markers=new Array,a.baseUrl=b.BASE_URL,a.curr_lat=0,a.curr_long=0;var l="";a.call=function(a){window.open("tel:"+a.trim(),"_system")},a.locate=function(a,b){window.open("https://maps.google.com?saddr=Current%20Location&daddr="+a+","+b,"_system")},e.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),i(),a.loadData=function(){var b=a.users.length;c.get("emergency"+l+"&start="+b).then(function(b){if(200==b.code){var c=_(b.data).toArray();a.users=_.union(a.users,c),a.moreData=!1}else a.moreData=!0;a.$broadcast("scroll.infiniteScrollComplete")})},a.emergencyCall=function(){window.open("tel:999","_system")},a.changeView=function(b){a.view=b},a.popUserInfo=function(a,b){e.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),h.getCurrentPosition({timeout:6e4}).then(function(a){k(a.coords.latitude,a.coords.longitude,b)})},a.closePopup=function(){a.popUser=null},a.showProfile=function(a){c.updateViewCnt(a).then(function(b){g.path("/app/profile/"+a)})}}]),sehaApp.controller("FooterCtrl",["$scope","$state",function(a,b){a.NavActivity=function(a){b.go(a)}}]),sehaApp.controller("HomeCtrl",["$scope","CONSTS","Data","$state","$ionicModal","$ionicLoading","$location","$localStorage","$translate","$rootScope","NgMap","$geolocation",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){f.hide(),n(function(b){$.getJSON("https://maps.googleapis.com/maps/api/geocode/json?latlng="+b.latitude+"%2C"+b.longitude+"&language=en",function(b){var c=o(b.results[0].address_components);a.user.location=c.state}),c.get("nearby_subscribers?lat="+b.latitude+"&lng="+b.longitude).then(function(c){var d=a.users=200==c.code?_(c.data).toArray():null;a.curr_lat=b.latitude,a.curr_long=b.longitude,f.hide(),a.dynMarkers=[],k.getMap().then(function(b){var c=new google.maps.LatLngBounds;for(var e in d){var f=d[e];a.dynMarkers.push(f),c.extend(f.getPosition())}a.markerClusterer=new MarkerClusterer(b,a.dynMarkers,{}),b.setCenter(c.getCenter()),b.fitBounds(c)})})})}function n(a){l.getCurrentPosition({timeout:6e4}).then(function(b){a({latitude:b.coords.latitude,longitude:b.coords.longitude})})}function o(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];switch(d.types[0]){case"locality":b.city=d.long_name;break;case"administrative_area_level_1":b.state=d.long_name;break;case"country":b.country=d.long_name}}return b}f.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),h.lastNotification="undefined"!=typeof h.lastNotification||null!=h.lastNotification?h.lastNotification:0,a.users=[],a.baseUrl=b.BASE_URL,a.citySuggest=[],a.typing=!1,a.department=[],a.curr_lat=0,a.curr_long=0,a.popUser=null,a.user={location:"",service:"",service_id:0},m(),a.showProfile=function(a){c.updateViewCnt(a).then(function(b){g.path("/app/profile/"+a)})},a.popUserInfo=function(b,d,e){a.popUser=null,f.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),c.get("profile?id="+d+"&lat="+a.curr_lat+"&lng="+a.curr_long).then(function(b){a.popUser=200==b.code?b.data:null,f.hide()}),a.popUsrAdData=e},c.get("departments_all").then(function(b){a.department=200==b.code?_(b.data).toArray():null}),a.showProfile=function(a){f.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),c.updateViewCnt(a).then(function(b){g.path("/app/profile/"+a)})},e.fromTemplateUrl("templates/modals/services.html",{scope:a,animation:"slide-in-up"}).then(function(b){a.modal=b}),a.showServices=function(){a.modal.show()},a.closeModal=function(){a.modal.hide()},a.$on("$destroy",function(){a.modal.remove()}),a.getService=function(b,c){a.user.service=c,a.user.service_id=b,a.modal.hide(),g.path("/app/search").search({catID:b,location:a.user.location,q:""})},a.getDept=function(b){g.path("/app/search").search({catID:"",location:a.user.location,q:"",deptID:b}),a.modal.hide()},h.lang="undefined"!=typeof h.lang&&null!=h.lang?h.lang:"English",i.use(h.lang),c.get("city_suggest").then(function(b){a.citySuggest=200==b.code?_(b.data).toArray():null}),a.choseLocation=function(b){a.user.location=b,a.typing=!1},a.spinIcon=function(){$(document).find("#location_spin_i").removeClass("focusSpinOut").addClass("focusSpin")},a.spinIconOut=function(){$(document).find("#location_spin_i").removeClass("focusSpin").addClass("focusSpinOut")},a.closePopup=function(){a.popUser=null}}]),sehaApp.controller("ListedCtrl",["$scope","$state","Data","$ionicLoading","$translate","$rootScope","$ionicModal","$ionicActionSheet","$ionicScrollDelegate","$q","CONSTS","$timeout","$geolocation",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){o(function(b){a.user.latitude=b.latitude,a.user.longitude=b.longitude;var c="https://maps.googleapis.com/maps/api/geocode/json?latlng="+b.latitude+","+b.longitude;$.getJSON(c,function(b){if("OK"==b.status){for(var c=b.results[0],e="",f="",g="",h=0,i=c.address_components.length;h<i;h++){var j=c.address_components[h];j.types.indexOf("administrative_area_level_1")>=0&&(f=j.long_name),j.types.indexOf("sublocality_level_1")>=0&&(e=j.long_name),j.types.indexOf("country")>=0&&(g=j.long_name)}""!=f&&(a.user.city=e,a.user.state=f,a.user.country=g),d.hide()}})})}function o(a){m.getCurrentPosition({timeout:6e4}).then(function(b){a({latitude:b.coords.latitude,longitude:b.coords.longitude})})}function p(a){if(parsed_url={},null==a||0==a.length)return parsed_url;switch(protocol_i=a.indexOf("://"),parsed_url.protocol=a.substr(0,protocol_i),remaining_url=a.substr(protocol_i+3,a.length),domain_i=remaining_url.indexOf("/"),domain_i=domain_i==-1?remaining_url.length-1:domain_i,parsed_url.domain=remaining_url.substr(0,domain_i),parsed_url.path=domain_i==-1||domain_i+1==remaining_url.length?null:remaining_url.substr(domain_i+1,remaining_url.length),domain_parts=parsed_url.domain.split("."),domain_parts.length){case 2:parsed_url.subdomain=null,parsed_url.host=domain_parts[0],parsed_url.tld=domain_parts[1];break;case 3:parsed_url.subdomain=domain_parts[0],parsed_url.host=domain_parts[1],parsed_url.tld=domain_parts[2];break;case 4:parsed_url.subdomain=domain_parts[0],parsed_url.host=domain_parts[1],parsed_url.tld=domain_parts[2]+"."+domain_parts[3]}return parsed_url.parent_domain=parsed_url.host+"."+parsed_url.tld,parsed_url}d.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),a.user={name_en:"",name_ar:"",category:"",email:"",contact_no:"",description_en:"",latitude:"",longitude:"",city:"",state:"",country:"",url:"",host:"",departments:[]},a.department=[],a.categories=[],a.chosenItems=[],c.get("parent_category").then(function(b){a.categories=200==b.code?b.data:null,d.hide()}),a.shareLocation=function(){d.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),n()},c.get("departments_all").then(function(b){a.department=200==b.code?_(b.data).toArray():null}),g.fromTemplateUrl("templates/modals/departments.html",{scope:a,animation:"slide-in-up"}).then(function(b){a.modal=b}),a.showModal=function(){a.modal.show()},a.closeModal=function(){a.user.departments=[],a.chosenItems=_.where(a.department,{checked:!0}),_.each(a.chosenItems,function(b){a.user.departments.push(b.id)}),a.modal.hide()},a.$on("$destroy",function(){a.modal.remove()}),a.$on("modal.hidden",function(){}),a.$on("modal.removed",function(){}),a.sendRequest=function(b){if(b||""!=a.user.name_en||""!=a.user.name_ar){d.show({template:'<div class="hg-loader"></div>',noBackdrop:!0});var f=p(a.user.url);a.user.host=f.host,c.post("get_listed",a.user).then(function(b){d.hide(),200==b.code?(e(["your_request_has_send"]).then(function(a){}),a.user={name_en:"",name_ar:"",category:"",email:"",contact_no:"",description_en:"",latitude:"",longitude:"",city:"",state:"",country:"",url:"",host:"",departments:[]},a.chosenItems=0):e(["failed_to_submit_due_to_an_error"]).then(function(a){})})}else e(["failed_form_has_errors"]).then(function(a){})}}]),sehaApp.controller("NewsCtrl",["$scope","Data","CONSTS","$ionicLoading","$rootScope",function(a,b,c,d,e){d.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),a.news=[],a.ads=[],a.baseUrl=c.BASE_URL,b.get("news").then(function(b){a.news=200==b.code?_(b.data).toArray():null,d.hide()}),a.LoadData=function(){var c=a.news.length;b.get("news?start="+c).then(function(b){if(200==b.code){var c=_(b.data).toArray();a.news=_.union(a.news,c)}else a.moreData=!0;a.$broadcast("scroll.infiniteScrollComplete")})},b.get("mobile_ads").then(function(b){a.ads=200==b.code?_(b.data).toArray():null});var f=-1;a.getAdBanner=function(){return f=++f,!(!a.ads[f]||"undefined"==typeof a.ads[f])&&a.ads[f]},a.goUrl=function(a){window.open(a,"_system")},a.share=function(a,b,c){},a.shareAd=function(a,b){}}]),sehaApp.controller("NewsDetailsCtrl",["$scope","Data","CONSTS","$stateParams","$ionicLoading",function(a,b,c,d,e){e.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),a.news=[],a.ads=[],a.baseUrl=c.BASE_URL,b.get("news_details?id="+d.id).then(function(b){a.news=200==b.code?b.data:null,e.hide()}),a.share=function(a,b,c){}}]),sehaApp.controller("NotificationsCtrl",["$scope","Data","$ionicLoading","$interval","$localStorage","$location","$translate",function(a,b,c,d,e,f,g){a.notifications=[],a.count=0,a.moredata=!1,a.showNote=function(a){return e.lang===a},b.get("notifications").then(function(b){b.error?c.show({template:b.data,duration:1e3}):a.notifications=b.data}),a.loadMoreData=function(){var c=a.notifications.length;b.get("notifications?start="+c).then(function(b){if(b.data.length>0)for(i=0;i<b.data.length;i++)a.notifications.push(b.data[i]);else a.moredata=!0;a.$broadcast("scroll.infiniteScrollComplete")})},a.doRefresh=function(){var d=$(".notification_id").val();b.get("latest_notifications?checkpoint="+d).then(function(b){if(b.error)g(["no_notifications"]).then(function(a){c.show({template:a.no_notifications,duration:1e3})});else for(i=0;i<b.data.length;i++)a.notifications.push(b.data[i]);a.$broadcast("scroll.refreshComplete")})},d(function(){var c=e.lastNotification;b.get("all_latest_notifications?checkpoint="+c).then(function(b){b.data.length>0&&(a.count=b.data.length,$(document).find("#badge-notify").html(a.count),$(document).find("#badge-notify").show(),e.lastNotification=b.data[0].job_id,a.notifications=b.data)})},15e3),a.rstNotificationCnt=function(){$(document).find("#badge-notify").hide(),a.count=0}}]),sehaApp.controller("PinboardsCtrl",["$scope","Data","CONSTS","$location","$ionicLoading",function(a,b,c,d,e){e.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),a.pinboards=[],a.baseUrl=c.BASE_URL,b.get("pinboards").then(function(b){a.pinboards=200==b.code?_(b.data).toArray():null,e.hide()}),a.loadData=function(){var c=a.pinboards.length;b.get("pinboards?start="+c).then(function(b){if(200==b.code){var c=_(b.data).toArray();a.pinboards=_.union(a.pinboards,c)}else a.moreData=!0;a.$broadcast("scroll.infiniteScrollComplete")})},a.call=function(a){window.open("tel:"+a.trim(),"_system")},a.locate=function(a,b){window.open("https://maps.google.com?saddr=Current%20Location&daddr="+a+","+b,"_system")},a.getOffer=function(a,b){d.path("/app/appointment/"+a+"/"+b)},a.share=function(a,b,c){}}]),sehaApp.controller("PinboardDetailsCtrl",["$scope","Data","CONSTS","$stateParams","$ionicLoading","$location",function(a,b,c,d,e,f){e.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),a.pinboard=[],a.baseUrl=c.BASE_URL,b.get("pinboard_detials?id="+d.id).then(function(b){a.pinboard=200==b.code?b.data:null,e.hide()}),a.call=function(a){window.open("tel:"+a.trim(),"_system")},a.locate=function(a,b){window.open("https://maps.google.com?saddr=Current%20Location&daddr="+a+","+b,"_system")},a.getOffer=function(a,b){f.path("/app/appointment/"+a+"/"+b)},a.share=function(a,b,c){}}]),sehaApp.controller("ProfileCtrl",["$scope","Data","$stateParams","CONSTS","$state","$location","Auth","$localStorage","$ionicLoading","$ionicScrollDelegate","$ionicPosition","$timeout","$translate","$ionicSlideBoxDelegate","$ionicModal",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){a.loading_featured=!0,a.featured_user=null,b.get("featured_user").then(function(b){a.featured_user=200==b.code&&b.data,a.loading_featured=!1})}i.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),a.user=[],a.images=[],a.baseUrl=d.BASE_URL,a.view="map",a.markers=new Array,a.socialMedias=[],a.pinboards=[],a.departments=[],a.featured_user=null,a.loading_featured=!0,a.ask={name:"",email:"",department:"",message:"",subscriber:c.id},a.goParent=function(){e.go("app.home")},a.$on("$ionicView.beforeEnter",function(d){b.get("profile?id="+c.id).then(function(d){i.hide(),200==d.code&&(a.user=d.data,b.get("social_medias?user="+c.id).then(function(b){a.socialMedias=200==b.code?b.data:[],i.hide()}),b.get("user_offers?id="+c.id).then(function(b){a.pinboards=200==b.code?b.data:null,i.hide()}),b.get("departments?id="+c.id).then(function(b){a.departments=200==b.code?b.data:null}),1==a.user.is_featured?(b.get("images?id="+c.id).then(function(b){a.images=200==b.code&&_(b.data).toArray(),n.update()}),a.imageUrl=a.baseUrl+"uploads/gallery/photo"):p())})}),a.showProfile=function(a){b.updateViewCnt(a).then(function(b){f.path("/app/profile/"+a)})},a.goUrl=function(a){var a=0!=a.indexOf("http://")?"http://"+a:a;window.open(a,"_system")},a.goSmUrl=function(a){window.open(a,"_system")},a.getUsersByDept=function(a){f.path("/app/search").search({catID:"",location:"",q:"",deptID:a})},a.reviewActivity=function(){f.path("/app/review/"+c.id)},a.share=function(a,b){},a.call=function(a){window.open("tel:"+a,"_system")},a.locate=function(a,b,c){window.open("https://maps.google.com?saddr=Current%20Location&daddr="+b+","+c,"_system")},a.getOffers=function(){f.path("/app/profile_offers/"+c.id)},o.fromTemplateUrl("templates/modals/ask-doctor.html",{scope:a,animation:"slide-in-up"}).then(function(b){a.modal=b}),a.showModal=function(){a.modal.show()},a.closeModal=function(){a.modal.hide()},a.$on("$destroy",function(){a.modal.remove()}),a.$on("modal.hidden",function(){}),a.$on("modal.removed",function(){}),a.sendMessage=function(d){d?(i.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),b.post("ask_doctor",a.ask).then(function(b){i.hide(),200==b.code?(m(["success_ask_doctor"]).then(function(a){}),a.ask={name:"",email:"",department:"",message:"",subscriber:c.id},a.modal.hide()):m(["failed_to_submit_due_to_an_error"]).then(function(a){})})):m(["failed_form_has_errors"]).then(function(a){})}}]),sehaApp.controller("ProfileOfferCtrl",["$scope","Data","$stateParams","CONSTS","$state","Auth","$ionicLoading","$translate","$location",function(a,b,c,d,e,f,g,h,i){g.show({template:'<div class="hg-loader"></div>'}),a.user=[],a.pinboards=[],a.baseUrl=d.BASE_URL,b.get("profile?id="+c.userID).then(function(d){a.user=200==d.code?d.data:null,b.get("user_offers?id="+c.userID).then(function(b){a.pinboards=200==b.code?b.data:null,g.hide()})}),a.loadData=function(){var d=a.pinboards.length;b.get("user_offers?id="+c.userID+"&start="+d).then(function(b){if(200==b.code){var c=_(b.data).toArray();a.pinboards=_.union(a.pinboards,c)}else a.moreData=!0;a.$broadcast("scroll.infiniteScrollComplete")})},a.profileNav=function(){i.path("/app/profile/"+c.userID)},a.call=function(a){window.open("tel:"+a.trim(),"_system")},a.locate=function(a,b){window.open("https://maps.google.com?saddr=Current%20Location&daddr="+a+","+b,"_system")},a.getOffer=function(a,b){i.path("/app/appointment/"+a+"/"+b)},a.share=function(a,b,c){}}]).controller("ProfileReviewCtrl",["$scope","Data","$stateParams","CONSTS","$state","$ionicLoading","$translate","$location","$ionicModal",function(a,b,c,d,e,f,g,h,i){f.show({template:'<div class="hg-loader"></div>'}),a.user=[],a.baseUrl=d.BASE_URL,a.reviews=[],a.user=[],b.get("profile?id="+c.id).then(function(d){a.user=200==d.code?d.data:null,b.get("reviews?user="+c.id).then(function(b){a.reviews=200==b.code?b.data:null,f.hide()})}),a.loadData=function(){var d=a.reviews.length;b.get("reviews?user="+c.id+"&start="+d).then(function(b){if(200==b.code){var c=_(b.data).toArray();a.reviews=_.union(a.reviews,c)}else a.moreData=!0;a.$broadcast("scroll.infiniteScrollComplete")})},a.goParent=function(){h.path("/app/profile/"+c.id)},a.call=function(a){window.open("tel:"+a.trim(),"_system")},a.review={rating:1,message:"",name:"",subscriber:c.id},i.fromTemplateUrl("templates/modals/review.html",{scope:a,animation:"slide-in-up"}).then(function(b){a.modal=b}),a.addReviewActivity=function(){a.modal.show()},a.closeModal=function(){a.modal.hide()},a.$on("$destroy",function(){a.modal.remove()}),a.$on("modal.hidden",function(){}),a.$on("modal.removed",function(){}),a.rateUser=function(d){d?(f.show({template:'<div class="hg-loader"></div>'}),b.post("review",a.review).then(function(d){f.hide(),200==d.code?(g(["your_rating_has_submit_for_approval"]).then(function(a){}),a.modal.hide(),b.get("reviews?user="+c.id).then(function(b){a.reviews=200==b.code?b.data:null,f.hide()})):g(["failed_to_submit_due_to_an_error"]).then(function(a){})})):g(["failed_form_has_errors"]).then(function(a){})}}]).controller("ProfileAppointmentCtrl",["$scope","Data","$stateParams","CONSTS","$state","$location","Auth","$localStorage","$ionicLoading","$translate","$timeout",function(a,b,c,d,e,f,g,h,i,j,k){i.show({template:'<div class="hg-loader"></div>'}),a.user=[],a.offer=null,a.baseUrl=d.BASE_URL,a.departments=[];var l=null;a.userForm={name:"",contact:"",email:"",voucher_code:"",message:"",voucher:0},b.get("profile?id="+c.userID).then(function(b){a.user=200==b.code?b.data:null,i.hide()}),a.profileNav=function(){f.path("/app/profile/"+c.userID)},a.findVoucher=function(){e.go("app.pinboards")},null!=c.offerID&&c.offerID&&"null"!=c.offerID&&b.get("offer?id="+c.offerID).then(function(b){a.offer=200==b.code?b.data:null,a.userForm.voucher=1,a.userForm.voucher_code=a.offer?a.offer.voucher_code:"",a.userForm.department=a.offer?a.offer.title_en:"",l=a.offer.voucher_code}),a.toggleVoucher=function(){a.userForm.voucher=1==a.userForm.voucher?0:1,0==a.userForm.voucher?a.userForm.voucher_code="":a.userForm.voucher_code=null!=l?l:""},a.appointment=function(d){if(d){i.show({template:'<div class="hg-loader"></div>',noBackdrop:!0});var e={name:a.userForm.name,contact:a.userForm.contact,message:a.userForm.message,email:a.userForm.email,subs:c.userID};b.post("send_app",e).then(function(b){i.hide(),b.error?j(["failed"]).then(function(a){}):(a.userForm={name:"",contact:"",email:"",message:""},f.path("/app/profile/"+c.userID),j(["appointment_response"]).then(function(a){}))})}else j(["failed"]).then(function(a){})}}]),sehaApp.controller("SearchCtrl",["$scope","Data","$state","$localStorage","$stateParams","CONSTS","$location","Auth","$ionicLoading","$ionicModal","$rootScope","$geolocation",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){l.getCurrentPosition({timeout:6e4}).then(function(b){q="?catId="+t.catId+"&lat="+b.coords.latitude+"&lng="+b.coords.longitude+"&ins=&city=&q="+t.q+"&lqry="+t.location+"&deptId="+t.deptId,n({dept:t.deptId,lat:b.coords.latitude,lng:b.coords.longitude},function(b){a.offers=b,a.showOfferPopup=!!b,o(q)}),a.curr_lat=r=b.coords.latitude,a.curr_long=s=b.coords.longitude})}function n(a,c){i.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),b.get("offers_popup?dept="+a.dept+"&lat="+a.lat+"&lng="+a.lng).then(function(a){c(200==a.code?_(a.data).toArray():null),i.hide()})}function o(c){b.get("find"+c).then(function(b){a.users=200==b.code?_(b.data).toArray():null,a.curr_lat=r=200==b.code?a.users[0].latitude:null,a.curr_long=s=200==b.code?a.users[0].longitude:null})}function p(c,d,e){b.get("profile?id="+e+"&lat="+c+"&lng="+d).then(function(b){a.popUser=200==b.code?b.data:null,i.hide()})}i.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),a.users=[],a.insurance=[],a.city=[],a.baseUrl=f.BASE_URL,a.view="list",a.popUser=null;var q="";a.curr_lat=0,a.curr_long=0;var r=0,s=0;a.offers=[],a.showOfferPopup=!1;var t={catId:g.search().catID,location:g.search().location,q:g.search().q,deptId:g.search().deptID};a.userFilter={city:"",ins:"",he:"0"},m(),a.closePopup=function(){a.showOfferPopup=!1},a.loadData=function(){var c=a.users.length;b.get("find"+q+"&start="+c).then(function(b){if(200==b.code){var c=_(b.data).toArray();a.users=_.union(a.users,c),a.moreData=!1}else a.moreData=!0;a.$broadcast("scroll.infiniteScrollComplete")})},a.showProfile=function(a){b.updateViewCnt(a).then(function(b){g.path("/app/profile/"+a)})},a.navActivity=function(a,b){window.open("https://maps.google.com?saddr=Current%20Location&daddr="+a+","+b,"_system")},a.makeAppointment=function(a,b){g.path("/app/appointment/"+a+"/"+b)},j.fromTemplateUrl("templates/modals/filter.html",{scope:a,animation:"slide-in-up"}).then(function(b){a.modal=b}),a.showFilter=function(){a.modal.show()},a.closeModal=function(){a.modal.hide()},a.$on("$destroy",function(){a.modal.remove()}),a.$on("modal.hidden",function(){}),a.$on("modal.removed",function(){}),b.get("insurance").then(function(b){a.insurance=200==b.code?_(b.data).toArray():null}),b.get("city").then(function(b){a.city=200==b.code?_(b.data).toArray():null}),a.submitSearch=function(){a.modal.hide();var b="?catId="+g.search().catID+"&lat=&lng=&ins="+a.userFilter.ins+"&city="+a.userFilter.city+"&q="+t.q+"&deptId="+t.deptId;o(b)},a.changeView=function(b){a.view=b},a.popUserInfo=function(b,c,d){i.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),l.getCurrentPosition({timeout:6e4}).then(function(a){p(a.coords.latitude,a.coords.longitude,c)}),a.popUsrAdData=d},a.closePopupInfo=function(){a.popUser=null},a.callOffer=function(a){window.open("tel:"+a,"_system")},a.getOffer=function(a,b){g.path("/app/appointment/"+a+"/"+b)},a.showOffer=function(a){g.path("/app/pinboard_details/"+a)}}]),sehaApp.controller("SettingsCtrl",["$scope","CONSTS","Data","$ionicModal","$ionicPopup","$localStorage","$translate",function(a,b,c,d,e,f,g){a.user={countryOpt:"undefined"!=typeof f.country&&null!=f.country?f.country:"",languageOpt:"undefined"!=typeof f.lang&&null!=f.lang?f.lang:"Arabic",countryEn:"undefined"!=typeof f.countryEn&&null!=f.countryEn?f.countryEn:"",countryAr:"undefined"!=typeof f.countryAr&&null!=f.countryAr?f.countryAr:""},a.isNotificationEnabled="undefined"==typeof f.enableNotification||null==f.enableNotification||f.enableNotification,a.country=[],a.showPopup=function(){g(["choose_country","change","cancel"]).then(function(b){e.alert({title:b.choose_country,templateUrl:"templates/modals/country.html",scope:a,buttons:[{text:b.change,type:"button-primary button-dk",onTap:function(b){f.country=a.user.countryOpt}},{text:b.cancel,type:"button-default",onTap:function(a){}}]})})},a.showPopupLang=function(){g(["choose_language","change"]).then(function(b){e.alert({title:b.choose_language,templateUrl:"templates/modals/language.html",scope:a,buttons:[{text:b.change,type:"button-primary button-block button-dk",onTap:function(b){f.lang=a.user.languageOpt,g.use(f.lang)}}]})})},c.get("country").then(function(b){a.country=200==b.code?_(b.data).toArray():null}),a.setCountry=function(b){f.country=b.id,a.user.countryEn=f.countryEn=b.name_en,a.user.countryAr=f.countryAr=b.name_ar}}]),sehaApp.controller("SidemenuCtrl",["$scope","$state","$translate","$localStorage","$translate",function(a,b,c,d,c){a.settingsActivity=function(){b.go("app.settings")},a.changeLanguage=function(a){d.lang=a,c.use(d.lang)},a.shareApp=function(){}}]),sehaApp.controller("SponsorCtrl",["$scope","CONSTS","Data","$state","$ionicLoading","$window",function(a,b,c,d,e,f){e.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),a.sponsorBanner=!1,a.baseUrl=b.BASE_URL,a.showAd=!0,c.get("sponsor_banner").then(function(b){a.sponsorBanner=200==b.code&&b.data,e.hide()}),a.goUrl=function(a){f.open(a,"_system")},a.closeSponsorAd=function(){a.showAd=!1}}]),sehaApp.controller("TipsCtrl",["$scope","Data","CONSTS","$ionicLoading","$timeout",function(a,b,c,d,e){d.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),a.tips=[],a.ads=[],a.baseUrl=c.BASE_URL,b.get("tips").then(function(b){a.tips=200==b.code?_(b.data).toArray():null,d.hide()}),b.get("mobile_ads").then(function(b){a.ads=200==b.code?_(b.data).toArray():null});var f=-1;a.getAdBanner=function(){return f=++f,!(!a.ads[f]||"undefined"==typeof a.ads[f])&&a.ads[f]},a.LoadData=function(){var c=a.tips.length;b.get("tips?start="+c).then(function(b){if(200==b.code){var c=_(b.data).toArray();a.tips=_.union(a.tips,c)}else a.moreData=!0;a.$broadcast("scroll.infiniteScrollComplete")})},a.share=function(a,b,c){},a.shareAd=function(a,b){}}]),sehaApp.controller("TipsDetailsCtrl",["$scope","Data","CONSTS","$stateParams","$ionicLoading",function(a,b,c,d,e){e.show({template:'<div class="hg-loader"></div>',noBackdrop:!0}),a.tips=[],a.baseUrl=c.BASE_URL,b.get("tips_details?id="+d.id).then(function(b){a.tips=200==b.code?b.data:null,e.hide()}),a.share=function(a,b,c){}}]);