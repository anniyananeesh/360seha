var module=angular.module("ngRateIt",["ng"]);module.directive("ngRateIt",["$q",function(e){"use strict";var t=function(t,r,n){n.readOnly||(t.readOnly=function(){return!1}),n.resetable||(t.resetable=function(){return!0}),n.beforeRated||(t.beforeRated=function(){var t=e.defer();return t.resolve(),t.promise}),n.rated||(t.rated=function(){}),n.beforeReset||(t.beforeReset=function(){var t=e.defer();return t.resolve(),t.promise}),n.reset||(t.reset=function(){}),n.over||(t.over=function(){})};return{scope:{ngModel:"=",min:"=?min",max:"=?max",step:"=?step",readOnly:"&?readOnly",pristine:"=?pristine",resetable:"&?resetable",starWidth:"=?starWidth",starHeight:"=?starHeight",rated:"=?rated",reset:"=?reset",over:"=?over",beforeRated:"=?beforeRated",beforeReset:"=?beforeReset"},templateUrl:"ngRateIt/ng-rate-it.html",require:"ngModel",replace:!0,link:t,controller:"ngRateItController"}}]).controller("ngRateItController",["$scope","$timeout",function(e,t){"use strict";e.isHovering=!1,e.offsetLeft=0,e.orgValue=angular.copy(e.ngModel),e.hoverValue=0,e.min=e.min||0,e.max=e.max||5,e.step=e.step||.5,e.pristine=e.orgValue===e.ngModel,e.starWidth=e.starWidth||16,e.starHeight=e.starHeight||16,e.resetCssOffset=4;var r=e.$watch("ngModel",function(){e.pristine=e.orgValue===e.ngModel});e.removeRating=function(){e.resetable()&&!e.readOnly()&&e.beforeReset().then(function(){e.ngModel=e.min,e.reset()})},e.setValue=function(r){e.isHovering=!0,e.offsetLeft=0;var n=r.originalTarget||r.srcElement;if(e.offsetLeft=n.getBoundingClientRect().left,e.hoverValue=Math.round((parseInt(r.gesture.touches[0].clientX)-e.offsetLeft)/e.starWidth/e.step)*e.step,e.over(r,e.hoverValue),e.isHovering&&!e.readOnly()){var o=angular.copy(e.min+e.hoverValue);e.beforeRated(o).then(function(){e.ngModel=o,e.isHovering=!1,t(function(){e.rated()})})}},e.onEnter=function(t){e.isHovering=!0,e.offsetLeft=0;var r=t.originalTarget||t.srcElement;e.offsetLeft=r.getBoundingClientRect().left},e.onHover=function(t){console.log("mourse hover"),e.isHovering=!0,e.hoverValue=Math.round((t.clientX-e.offsetLeft)/e.starWidth/e.step)*e.step,e.over(t,e.hoverValue)},e.onLeave=function(){console.log("mourse leace"),e.isHovering=!1,e.hoverValue=0},e.$on("$destroy",function(){r()})}]).run(["$templateCache",function(e){"use strict";e.put("ngRateIt/ng-rate-it.html","<div class=\"ngrateit\" ng-class=\"{'ngrateit-readonly': readOnly()}\"><a class=\"ngrateit-background ngrateit-reset\" ng-mouseenter=\"resetCssOffset=5;\" ng-mouseleave=\"resetCssOffset=4;\" ng-if=\"!readOnly() && resetable()\" ng-click=\"removeRating()\" ng-style=\"{'width': starWidth+'px', 'height': starHeight+'px', 'background-position': '0 '+(-resetCssOffset*starHeight)+'px'}\"></a><div class=\"ngrateit-star_wrapper\" on-touch=\"setValue($event)\" ng-style=\"{'width': ((max-min)*starWidth)+'px', 'height': starHeight+'px'}\"><div class=\"ngrateit-background\"></div><div class=\"ngrateit-value\" ng-hide=\"!readOnly() && hoverValue>0 && hoverValue!==(ngModel-min)\" ng-style=\"{'width': (ngModel-min)*starWidth+'px', 'background-position': '0 '+(-2*starHeight)+'px'}\"></div><div class=\"ngrateit-hover\" ng-if=\"!readOnly() && hoverValue!==(ngModel-min)\" ng-style=\"{'width': hoverValue*starWidth+'px', 'background-position': '0 '+(-3*starHeight)+'px'}\" ></div></div></div>")}]);